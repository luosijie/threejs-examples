webpackJsonp([4],{ZO4P:function(e,t){},eIDq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={makeShape:function(){var e=void 0;if(window.THREE&&arguments.length){var t=arguments[0];(e=new THREE.Shape).moveTo(t[0][0],t[0][1]);for(var a=1;a<t.length;a++)e.lineTo(t[a][0],t[a][1]);if(arguments.length>1)for(var r=1;r<arguments.length;r++){var n=arguments[r],o=new THREE.Path;o.moveTo(n[0][0],n[0][1]);for(var i=1;i<n.length;i++)o.lineTo(n[i][0],n[i][1]);e.holes.push(o)}return e}console.error("Something wrong!")},makeExtrudeGeometry:function(e,t){var a={steps:1,amount:t,bevelEnabled:!1},r=new THREE.ExtrudeBufferGeometry(e,a);return r.rotateX(-.5*Math.PI),r},makeShapeGeometry:function(e){var t=this.makeShape(e);return new THREE.ShapeGeometry(t)},makeMesh:function(e,t,a){var r=void 0,n=void 0;return"lambert"===e?r=new THREE.MeshLambertMaterial({color:a}):"phong"===e?r=new THREE.MeshPhongMaterial({color:a}):console.error("unrecognized type!"),(n=new THREE.Mesh(t,r)).castShadow=!0,n.receiveShadow=!0,n}},n=function(e){var t=[2931378,4695808,14024704,556935,3648782,5066061,13532672,14721555,8895710],a=Math.floor(Math.random()*t.length);this.color=e||t[a],this.mesh=new THREE.Object3D,this.wheels=[],this.startAngle=0;var n=this;function o(e){var t=r.makeShape(e),a=r.makeExtrudeGeometry(t,.1);a.rotateX(.5*Math.PI);var n=r.makeMesh("phong",a,0);return n.castShadow=!1,n}!function(){var e=r.makeShape([[-13,2],[13,2],[13,8],[5,8],[3,13],[-8,13],[-10,8],[-13,8],[-13,2]]),t=r.makeExtrudeGeometry(e,14);t.translate(0,-7,0),t.rotateX(.5*Math.PI);var a=r.makeMesh("phong",t,n.color);n.mesh.add(a)}(),function(){var e=new THREE.Object3D,t=new THREE.Object3D,a=o([[-2,8],[4,8],[2.5,12],[-2,12]]);t.add(a);var i=o([[-9,8],[-3,8],[-3,12],[-7.5,12]]);t.add(i),t.position.z=7.1,e.add(t);var s=t.clone();s.position.z=-7.1,e.add(s);var h=new THREE.CubeGeometry(.1,5,12);h.rotateZ(.12*Math.PI),h.translate(4.2,10,0);var d=r.makeMesh("phong",h,0);e.add(d);var m=d.clone();m.rotation.z=-.24*Math.PI,m.position.x=-19,m.position.y=6,e.add(m),n.mesh.add(e)}(),function(){var e=new THREE.Geometry,t=new THREE.BoxGeometry(2,2,2);[[12.5,7.1,6.1],[12.5,7.1,-6.1],[-14,7.1,6.1],[-14,7.1,-6.1]].forEach(function(a){var r=a[0],n=a[1],o=a[2],i=t.clone();i.translate(r,n,o),e.merge(i)});var a=t.clone();a.scale(1,1.3,7.1),a.translate(12.1,3.3,0),e.merge(a);var o=a.clone();o.translate(-26,0,0),e.merge(o),e=(new THREE.BufferGeometry).fromGeometry(e);var i=r.makeMesh("phong",e,16777215);n.mesh.add(i)}(),function(){var e=i();e.position.set(8,3,-6),n.wheels.push(e),n.mesh.add(e);var t=i();t.position.set(8,3,6),n.wheels.push(t),n.mesh.add(t);var a=i();a.position.set(-8,3,6),n.wheels.push(a),n.mesh.add(a);var o=i();function i(){var e=new THREE.Object3D,t=new THREE.CylinderGeometry(3,3,3,32);t.rotateX(.5*Math.PI);var a=r.makeMesh("lambert",t,0);e.add(a);var n=r.makeMesh("lambert",t,14540253);n.castShadow=!1,n.scale.set(.8,.8,1.1),e.add(n);var o=new THREE.CylinderGeometry(1,1,3.6,4);o.rotateX(.5*Math.PI);var i=r.makeMesh("lambert",o,10987431);return i.castShadow=!1,e.add(i),e}o.position.set(-8,3,-6),n.wheels.push(o),n.mesh.add(o)}()};n.prototype={setPosition:function(e,t,a){this.mesh.position.set(e,t,a)},forward:function(e){e=e||1,this._moving(e,!0)},backward:function(e){e=e||1,this._moving(e,!1)},turnLeft:function(e,t){this._turn(e,!0,t)},turnRight:function(e,t){this._turn(e,!1,t)},_turn:function(e,t,a){if(t=t?1:-1,a){if(this.startAngle<e&&(this.mesh.rotation.y+=a,this.startAngle+=a,e-this.startAngle<a)){var r=this.mesh.rotation.y-this.startAngle;return this.mesh.rotation.y=r+e,void(this.startAngle=0)}}else this.mesh.rotation.y+=e*t},_moving:function(e,t){var a=this.mesh.rotation.y;t=t?1:-1;var r=e*Math.cos(a)*t,n=e*Math.sin(a)*t;this.mesh.position.x+=r,this.mesh.position.z-=n,this._rotateWheels(e)},_rotateWheels:function(e){this.wheels.forEach(function(t){t.rotation.z-=.1*e})}};var o=n,i={window:function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=32,e.height=32;var a="#3c3443",r="#9d94a7",n="#796e8c";t.fillStyle=a,t.fillRect(0,0,32,32),t.fillStyle=r,t.fillRect(2,2,13,13),t.fillStyle=r,t.fillRect(17,2,13,13),t.fillStyle=n,t.fillRect(2,17,13,13),t.fillStyle=n,t.fillRect(17,17,13,13);var o=new THREE.Texture(e);return o.wrapS=THREE.RepeatWrapping,o.wrapT=THREE.RepeatWrapping,o.needsUpdate=!0,o}},s=[[-110,-110],[-90,-110],[-70,-110],[-50,-110],[-30,-110],[-10,-110],[10,-110],[30,-110],[50,-110],[70,-110],[90,-110],[-110,110],[-110,90],[-110,70],[-110,50],[-110,30],[-110,10],[-110,-10],[-110,-30],[-110,-50],[-110,-70],[-110,-90],[110,110],[90,110],[70,110],[50,110],[30,110],[-30,110],[-50,110],[-70,110],[-90,110],[110,-110],[110,-90],[110,-70],[110,-50],[110,-30],[110,-10],[110,10],[110,30],[110,50],[110,70],[110,90]],h={name:"HelloWorld",data:function(){return{scene:null,camera:null,renderer:null,cars:[],width:"",height:"",config:{isMobile:!1,background:2631720}}},methods:{checkUserAgent:function(){var e=navigator.userAgent;(e.match(/Android/i)||e.match(/webOS/i)||e.match(/iPhone/i)||e.match(/iPad/i)||e.match(/iPod/i)||e.match(/BlackBerry/i))&&(this.config.isMobile=!0,this.camera.position.set(420,420,420),this.renderer.shadowMap.enabled=!1)},buildMovingCars:function(){var e=this;[[-130,145,0],[10,145,0],[145,20,.5],[30,-145,1],[-145,-60,1.5]].forEach(function(t){var a=new o,r=t[0],n=t[1],i=t[2];a.setPosition(r,0,n),a.mesh.rotation.y=i*Math.PI,e.cars.push(a),e.scene.add(a.mesh)})},buildStaticCars:function(){var e=this;[[-84,82,1.5],[-58,82,1.5],[-32,82,1.5],[84,82,1.5]].forEach(function(t){var a=new o,r=t[0],n=t[1],i=t[2];a.setPosition(r,0,n),a.mesh.rotation.y=i*Math.PI,e.scene.add(a.mesh)})},buildRoad:function(){var e=new THREE.Object3D,t=r.makeShape([[-160,160],[160,160],[160,-160],[-160,-160]],[[-159,159],[-159,-159],[159,-159],[159,159]]),a=r.makeExtrudeGeometry(t,.1),n=r.makeMesh("phong",a,16777215);e.add(n);var o=r.makeShape([[-131,131],[-131,-131],[131,-131],[131,131],[19,131],[19,99],[99,99],[99,-99],[-99,-99],[-99,99],[-19,99],[-19,131]]),i=r.makeExtrudeGeometry(o,.1),s=r.makeMesh("phong",i,16777215);s.rotation.y=Math.PI,e.add(s);for(var h=new THREE.Geometry,d=new THREE.BoxGeometry(20,.1,2),m=new THREE.Geometry,c=0;c<9;c++){var l=d.clone();l.translate(30*c,0,-1),m.merge(l)}m.translate(-120,0,145),h.merge(m);var E=m.clone();E.translate(0,0,-290),h.merge(E);var u=m.clone();u.rotateY(.5*Math.PI),h.merge(u);var v=m.clone();v.rotateY(-.5*Math.PI),h.merge(v),h=(new THREE.BufferGeometry).fromGeometry(h);var p=r.makeMesh("phong",h,16777215);e.add(p),this.scene.add(e)},buildbuilding:function(){var e,t,a,n,o,h,d,m=this,c=new THREE.BoxBufferGeometry(320,6,320),l=r.makeMesh("lambert",c,7298922);l.position.y=-3,this.scene.add(l),e=r.makeShape([[-130,-130],[-130,130],[130,130],[130,-130],[20,-130],[20,-120],[120,-120],[120,120],[-120,120],[-120,-120],[-20,-120],[-20,-130],[-130,-130]]),t=r.makeExtrudeGeometry(e,3),a=r.makeMesh("lambert",t,15059647),m.scene.add(a),n=r.makeShape([[-120,-120],[-120,120],[120,120],[120,-120],[20,-120],[20,-100],[100,-100],[100,100],[-100,100],[-100,-100],[-20,-100],[-20,-120],[-120,-120]]),o=r.makeExtrudeGeometry(n,3),h=r.makeMesh("lambert",o,12632170),m.scene.add(h),s.forEach(function(e){var t=e[0],a=e[1],n=function(e,t,a){e=e||0,t=t||0,a=a||0;var n=new THREE.Object3D,o=new THREE.BoxBufferGeometry(2,16,2),i=r.makeMesh("lambert",o,9068858);i.position.y=8,n.add(i);var s=new THREE.BoxBufferGeometry(8,8,8),h=r.makeMesh("lambert",s,10264157);return h.position.y=13,n.add(h),n.position.set(e,t,a),n}(t,1,a);m.scene.add(n)}),(d=function(){var e=new THREE.Object3D,t=new THREE.BoxBufferGeometry(180,3,140),a=r.makeMesh("lambert",t,16777215);a.position.y=1,e.add(a);var n=r.makeShape([[-80,-30],[-80,20],[50,20],[50,0],[20,-30],[-80,-30]]),o=r.makeExtrudeGeometry(n,100),s=new THREE.MeshPhongMaterial({map:i.window()});s.map.repeat.set(.1,.08);var h=new THREE.Mesh(o,s);h.castShadow=!0,h.receiveShadow=!0,e.add(h);var d=n,m=r.makeExtrudeGeometry(d,5),c=r.makeMesh("lambert",m,11642799);c.position.y=100,e.add(c);for(var l=new THREE.Geometry,E=new THREE.BoxGeometry(2,2,40),u=0;u<12;u++){var v=E.clone();v.translate(5*u,0,0),l.merge(v)}for(var p=0;p<2;p++){var f=E.clone();f.rotateY(.5*Math.PI),f.scale(1.6,1,1),f.translate(27,0,30*p-15),l.merge(f)}for(var w=[[0,0],[1,0],[0,1],[1,1]],g=0;g<w.length;g++){var y=w[g],M=E.clone();M.scale(1,1,.4),M.rotateX(.5*Math.PI),M.translate(55*y[0],0,30*y[1]-15),l.merge(M)}l=(new THREE.BufferGeometry).fromGeometry(l);var R=r.makeMesh("phong",l,16777215);R.position.set(-70,115,5),e.add(R);var T=new THREE.BoxBufferGeometry(150,3,90),H=r.makeMesh("lambert",T,496293);H.position.set(-3,18,25),e.add(H);var b=new THREE.BoxBufferGeometry(150,15,3),k=r.makeMesh("phong",b,496293);k.receiveShadow=!1,k.position.set(-3,24,68.5),e.add(k);var G=new THREE.BoxBufferGeometry(150,3,3),P=r.makeMesh("phong",G,16777215);P.position.set(-3,33,68.5),e.add(P);var S=new THREE.CylinderGeometry(2,2,15,32),x=r.makeMesh("lambert",S,16777215);x.position.set(-60,10,55),e.add(x);var I=x.clone();I.position.set(55,10,55),e.add(I);var B=new THREE.Object3D,C=new THREE.BoxBufferGeometry(4,106,4),_=r.makeMesh("phong",C,16777215),z=_.clone();z.position.set(-80,52,30),B.add(z);var A=_.clone();A.position.set(-80,52,-20),B.add(A);var O=_.clone();O.position.set(50,52,-18),B.add(O),e.add(B);var j=r.makeShape([[-82,-32],[20,-32],[52,0],[52,22],[-82,22],[-82,-32]],[[-78,-28],[20,-28],[48,0],[48,18],[-78,18],[-78,-28]]),L=r.makeExtrudeGeometry(j,8),D=r.makeMesh("phong",L,16777215);D.position.y=100,e.add(D);var W=r.makeShape([[-80,20],[-80,60],[80,60],[80,20],[-80,20]],[[-78,22],[78,22],[78,58],[-78,58],[-78,22]]),X=r.makeExtrudeGeometry(W,90),F=r.makeMesh("lambert",X,15917595);e.add(F);var U=r.makeShape([[0,0],[36,0],[36,70],[0,70],[0,0]],[[2,2],[34,2],[34,68],[2,68],[2,2]]),q=r.makeExtrudeGeometry(U,165),Y=r.makeMesh("lambert",q,16777215);Y.rotation.x=-.5*Math.PI,Y.rotation.z=-.5*Math.PI,Y.position.y=86,Y.position.z=-58,Y.position.x=-78,e.add(Y);var Z=new THREE.PlaneGeometry(32,66,1,1),J=new THREE.MeshPhongMaterial({map:i.window()});J.map.repeat.set(2,6);var $=new THREE.Mesh(Z,J);$.position.set(83,51,-40),$.rotation.y=.5*Math.PI,e.add($);var V=function(){var e=new THREE.Object3D,t=new THREE.PlaneGeometry(20,20),a=r.makeMesh("phong",t,6970996);e.add(a);var n=new THREE.BoxBufferGeometry(22,2,2),o=r.makeMesh("phong",n,16777215),i=o.clone();i.position.y=10,e.add(i);var s=o.clone();s.position.y=-10,e.add(s);var h=o.clone();h.rotation.z=.5*Math.PI,h.position.x=-10,e.add(h);var d=h.clone();return d.position.x=10,e.add(d),e}();V.scale.set(.6,.6,1),V.rotation.y=Math.PI,V.position.set(65,75,-61);for(var K=0;K<7;K++)for(var N=0;N<4;N++){var Q=V.clone();Q.position.x-=22*K,Q.position.y-=20*N,e.add(Q)}return e}()).position.z=-20,m.scene.add(d),[[-12.5,12.5,1.25],[-7.5,12.5,-.5],[-2.5,12.5,-.5],[2.5,12.5,-.5],[7.5,12.5,-.5],[12.5,12.5,-.25],[12.5,7.5,0],[12.5,2.5,0],[12.5,-2.5,0],[12.5,-7.5,0],[12.5,-12.5,.25],[7.5,-12.5,.5],[2.5,-12.5,.5],[-2.5,-12.5,.5],[-7.5,-12.5,.5],[-12.5,-12.5,.75],[-12.5,-7.5,1],[-12.5,-2.5,1],[-12.5,2.5,1],[-12.5,7.5,1]].forEach(function(e){var t=10*e[0],a=10*e[1],n=e[2],o=function(){var e=new THREE.Object3D,t=new THREE.CubeGeometry(2,30,2);t.translate(0,15,0);var a=r.makeMesh("phong",t,15454658);e.add(a);var n=new THREE.CubeGeometry(10,1,1),o=r.makeMesh("phong",n,2887182);o.position.set(3,30,0),e.add(o);var i=new THREE.CubeGeometry(6,2,4),s=void 0;return(s=r.makeMesh("phong",i,15454658)).position.set(10,30,0),e.add(s),e}();o.rotation.y=n*Math.PI,o.position.set(t,0,a),m.scene.add(o)})},buildLightSystem:function(){if(this.config.isMobile){var e=new THREE.HemisphereLight(16777215,1);this.scene.add(e);var t=new THREE.AmbientLight(16777215,.15);this.scene.add(t)}else{var a=new THREE.DirectionalLight(16777215,1.1);a.position.set(300,1e3,500),a.target.position.set(0,0,0),a.castShadow=!0;var r=300;a.shadow.camera=new THREE.OrthographicCamera(-r,r,r,-r,500,1600),a.shadow.bias=1e-4,a.shadow.mapSize.width=a.shadow.mapSize.height=1024,this.scene.add(a);var n=new THREE.AmbientLight(16777215,.3);this.scene.add(n)}},buildAuxSystem:function(){var e=new THREE.GridHelper(320,32);this.scene.add(e);var t=new THREE.OrbitControls(this.camera,this.renderer.domElement);t.enableDamping=!0,t.dampingFactor=.25,t.rotateSpeed=.35},carMoving:function(e){var t=e.mesh.rotation.y,a=e.mesh.position.x,r=e.mesh.position.z;a<145&&145===r?e.forward():t<.5*Math.PI?e.turnLeft(.5*Math.PI,.1):145===a&&r>-145?e.forward():t<Math.PI?e.turnLeft(.5*Math.PI,.1):a>-145&&-145==r?e.forward():t<1.5*Math.PI?e.turnLeft(.5*Math.PI,.1):-145===a&&r<145?(e.mesh.rotation.y=1.5*Math.PI,e.forward()):t<2*Math.PI?e.turnLeft(.5*Math.PI,.1):(e.setPosition(-145,0,145),e.mesh.rotation.set(0,0,0))},onWindowResize:function(){var e=this;window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix(),e.renderer.setSize(e.width,e.height)})},loop:function(){var e=this;this.cars.forEach(function(t){e.carMoving(t)}),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.loop)}},mounted:function(){this.width=window.innerWidth,this.height=window.innerHeight,this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(45,this.width/this.height,1,5e3),this.camera.position.set(330,330,330),this.camera.lookAt(this.scene.position),this.renderer=new THREE.WebGLRenderer({antialias:!0,canvas:document.querySelector("canvas")}),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(this.config.background),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.checkUserAgent(),this.buildAuxSystem(),this.buildLightSystem(),this.buildbuilding(),this.buildRoad(),this.buildStaticCars(),this.buildMovingCars(),this.loop(),this.onWindowResize()}},d={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("div",{staticClass:"info"},[t("a",{staticClass:"title",attrs:{href:"https://github.com/luosijie/threejs-examples",target:"_blank"}},[this._v("\n            Mini City\n        ")]),this._v(" "),t("a",{staticClass:"author",attrs:{href:"https://luosijie.github.io/",target:"_blank"}},[this._v("\n            Created By Jesse Luo\n        ")])]),this._v(" "),t("canvas")])}]};var m=a("VU/8")(h,d,!1,function(e){a("ZO4P")},"data-v-1525e070",null);t.default=m.exports}});
//# sourceMappingURL=4.5ef0b59b39aa549cfb0c.js.map